<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSAÈëëÂÆö‰ª£Ë°åÁî≥Ëæº„Éï„Ç©„Éº„É† - KanuCard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .form-container {
            padding: 40px;
        }

        .section {
            margin-bottom: 35px;
        }

        .section-title {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
        }

        .required {
            color: #e74c3c;
            margin-left: 4px;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .card-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-weight: 600;
            color: #333;
        }

        .remove-card {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .remove-card:hover {
            background: #c0392b;
        }

        .add-card-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .add-card-btn:hover {
            background: #5563d1;
        }

        .service-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .service-option {
            border: 2px solid #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .service-option:hover {
            border-color: #667eea;
        }

        .service-option.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .service-option input[type="radio"] {
            margin-right: 10px;
        }

        .service-name {
            font-weight: 600;
            color: #333;
        }

        .service-price {
            color: #667eea;
            font-size: 1.1rem;
            margin-top: 5px;
        }

        .service-description {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .total-section {
            background: #f0f0f0;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .total-label {
            font-weight: 600;
            color: #333;
        }

        .total-amount {
            font-size: 1.5rem;
            color: #667eea;
            font-weight: bold;
        }

        .submit-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .terms {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .terms h3 {
            margin-bottom: 10px;
            color: #333;
        }

        .terms ul {
            margin-left: 20px;
            color: #666;
        }

        .terms li {
            margin-bottom: 8px;
        }

        .checkbox-group {
            margin: 20px 0;
        }

        .checkbox-group input[type="checkbox"] {
            margin-right: 10px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .success-message {
            display: none;
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            display: none;
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .service-options {
                grid-template-columns: 1fr;
            }

            .form-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ PSAÈëëÂÆö‰ª£Ë°åÁî≥Ëæº„Éï„Ç©„Éº„É†</h1>
            <p>Â§ßÂàá„Å™„Ç´„Éº„Éâ„ÅÆÈëëÂÆö„ÇíÁßÅ„Åü„Å°„Å´„Åä‰ªª„Åõ„Åè„Å†„Åï„ÅÑ</p>
        </div>

        <div class="form-container">
            <div class="success-message" id="successMessage">
                Áî≥Ëæº„ÅåÊ≠£Â∏∏„Å´ÈÄÅ‰ø°„Åï„Çå„Åæ„Åó„Åü„ÄÇÁ¢∫Ë™ç„É°„Éº„É´„Çí„ÅäÈÄÅ„Çä„Åó„Åæ„Åó„Åü„ÅÆ„Åß„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ
            </div>

            <div class="error-message" id="errorMessage">
                „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ
            </div>

            <form id="applicationForm">
                <!-- È°ßÂÆ¢ÊÉÖÂ†±„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="section">
                    <h2 class="section-title">„ÅäÂÆ¢ÊßòÊÉÖÂ†±</h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label>„ÅäÂêçÂâçÔºàÂßìÔºâ<span class="required">*</span></label>
                            <input type="text" name="lastName" required placeholder="Â±±Áî∞">
                        </div>
                        <div class="form-group">
                            <label>„ÅäÂêçÂâçÔºàÂêçÔºâ<span class="required">*</span></label>
                            <input type="text" name="firstName" required placeholder="Â§™ÈÉé">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ<span class="required">*</span></label>
                        <input type="email" name="email" required placeholder="example@email.com">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>ÈõªË©±Áï™Âè∑<span class="required">*</span></label>
                            <input type="tel" name="phone" required placeholder="090-1234-5678">
                        </div>
                        <div class="form-group">
                            <label>ÈÉµ‰æøÁï™Âè∑</label>
                            <input type="text" name="postalCode" placeholder="123-4567">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>‰ΩèÊâÄ</label>
                        <input type="text" name="address" placeholder="Êù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫...">
                    </div>
                </div>

                <!-- „Ç´„Éº„ÉâÊÉÖÂ†±„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="section">
                    <h2 class="section-title">ÈëëÂÆö„Ç´„Éº„ÉâÊÉÖÂ†±</h2>

                    <div id="cardsContainer">
                        <div class="card-section" data-card-index="0">
                            <div class="card-header">
                                <span class="card-title">„Ç´„Éº„Éâ 1</span>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>„Ç´„Éº„ÉâÂêç<span class="required">*</span></label>
                                    <input type="text" name="cardName_0" required placeholder="‰æã: „Éî„Ç´„ÉÅ„É•„Ç¶ VMAX">
                                </div>
                                <div class="form-group">
                                    <label>„Çª„ÉÉ„ÉàÂêç</label>
                                    <input type="text" name="cardSet_0" placeholder="‰æã: 25th Anniversary">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>„Ç´„Éº„ÉâÁï™Âè∑</label>
                                    <input type="text" name="cardNumber_0" placeholder="‰æã: 001/025">
                                </div>
                                <div class="form-group">
                                    <label>Ë®ÄË™û</label>
                                    <select name="cardLanguage_0">
                                        <option value="Êó•Êú¨Ë™û">Êó•Êú¨Ë™û</option>
                                        <option value="Ëã±Ë™û">Ëã±Ë™û</option>
                                        <option value="„Åù„ÅÆ‰ªñ">„Åù„ÅÆ‰ªñ</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>ÊúüÂæÖ„Ç∞„É¨„Éº„Éâ</label>
                                <select name="expectedGrade_0">
                                    <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                    <option value="10">PSA 10 (GEM MINT)</option>
                                    <option value="9">PSA 9 (MINT)</option>
                                    <option value="8">PSA 8 (NM-MT)</option>
                                    <option value="7">PSA 7 (NM)</option>
                                    <option value="6‰ª•‰∏ã">PSA 6‰ª•‰∏ã</option>
                                    <option value="‰∏çÊòé">„Çè„Åã„Çâ„Å™„ÅÑ</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>ÂÇôËÄÉÔºà„Ç´„Éº„Éâ„ÅÆÁä∂ÊÖã„Å™„Å©Ôºâ</label>
                                <textarea name="cardNotes_0" placeholder="„Ç´„Éº„Éâ„ÅÆÁä∂ÊÖã„ÇÑÁâπË®ò‰∫ãÈ†Ö„Åå„ÅÇ„Çå„Å∞Ë®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
                            </div>
                        </div>
                    </div>

                    <button type="button" class="add-card-btn" onclick="addCard()">
                        <span>‚ûï</span> „Ç´„Éº„Éâ„ÇíËøΩÂä†
                    </button>
                </div>

                <!-- „Çµ„Éº„Éì„ÇπÈÅ∏Êäû„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="section">
                    <h2 class="section-title">„Çµ„Éº„Éì„ÇπÈÅ∏Êäû</h2>

                    <div class="service-options">
                        <div class="service-option" onclick="selectService('standard')">
                            <input type="radio" name="serviceType" value="standard" id="standardService" checked>
                            <label for="standardService">
                                <div class="service-name">„Çπ„Çø„É≥„ÉÄ„Éº„Éâ„Çµ„Éº„Éì„Çπ</div>
                                <div class="service-price">¬•3,000/Êûö</div>
                                <div class="service-description">ÈÄöÂ∏∏Á¥çÊúüÔºàÁ¥Ñ60-90Êó•Ôºâ</div>
                            </label>
                        </div>

                        <div class="service-option" onclick="selectService('express')">
                            <input type="radio" name="serviceType" value="express" id="expressService">
                            <label for="expressService">
                                <div class="service-name">„Ç®„ÇØ„Çπ„Éó„É¨„Çπ„Çµ„Éº„Éì„Çπ</div>
                                <div class="service-price">¬•5,000/Êûö</div>
                                <div class="service-description">ÁâπÊÄ•Á¥çÊúüÔºàÁ¥Ñ30-45Êó•Ôºâ</div>
                            </label>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 20px;">
                        <label>ÁâπË®ò‰∫ãÈ†Ö„Éª„ÅîË¶ÅÊúõ</label>
                        <textarea name="specialRequests" placeholder="„Åù„ÅÆ‰ªñ„ÅîË¶ÅÊúõ„Åå„ÅÇ„Çå„Å∞Ë®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
                    </div>
                </div>

                <!-- ÊñôÈáëÂêàË®à„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="total-section">
                    <div class="total-row">
                        <span class="total-label">„Ç´„Éº„ÉâÊûöÊï∞:</span>
                        <span id="totalCards">1Êûö</span>
                    </div>
                    <div class="total-row">
                        <span class="total-label">„Çµ„Éº„Éì„ÇπÊñôÈáë:</span>
                        <span id="servicePrice">¬•3,000/Êûö</span>
                    </div>
                    <div class="total-row" style="border-top: 2px solid #ccc; padding-top: 10px;">
                        <span class="total-label">ÂêàË®àÈáëÈ°çÔºàÁ®éËæºÔºâ:</span>
                        <span class="total-amount" id="totalAmount">¬•3,300</span>
                    </div>
                </div>

                <!-- Âà©Áî®Ë¶èÁ¥Ñ„Å®ÈÄÅ‰ø°„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="submit-section">
                    <div class="terms">
                        <h3>„ÅîÂà©Áî®„Å´„ÅÇ„Åü„Å£„Å¶</h3>
                        <ul>
                            <li>Áî≥ËæºÂæå„ÄÅË©≥Á¥∞„Å™ÊâãÈ†Ü„Çí„É°„Éº„É´„Åß„ÅîÊ°àÂÜÖ„ÅÑ„Åü„Åó„Åæ„Åô</li>
                            <li>„Ç´„Éº„Éâ„ÅÆÁô∫ÈÄÅÊñπÊ≥ï„ÇÑÊ¢±ÂåÖ„Å´„Å§„ÅÑ„Å¶„ÅîË™¨Êòé„ÅÑ„Åü„Åó„Åæ„Åô</li>
                            <li>PSA„Å∏„ÅÆÊèêÂá∫Ââç„Å´ÊúÄÁµÇÁ¢∫Ë™ç„ÅÆ„ÅîÈÄ£Áµ°„Çí„ÅÑ„Åü„Åó„Åæ„Åô</li>
                            <li>ÈëëÂÆöÁµêÊûú„ÅØ„É°„Éº„É´„Åß„ÅäÁü•„Çâ„Åõ„ÅÑ„Åü„Åó„Åæ„Åô</li>
                            <li>ËøîÂç¥ÊôÇ„ÅÆÈÄÅÊñô„ÅØÂà•ÈÄî„ÅîË≤†ÊãÖ„ÅÑ„Åü„Å†„Åç„Åæ„Åô</li>
                        </ul>
                    </div>

                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="agreeTerms" required>
                            <strong>Âà©Áî®Ë¶èÁ¥Ñ„Å´ÂêåÊÑè„Åó„Åæ„Åô</strong>
                        </label>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        Áî≥Ëæº„ÇíÈÄÅ‰ø°„Åô„Çã
                    </button>

                    <div class="loading" id="loadingSpinner">
                        <div class="spinner"></div>
                        <p>ÈÄÅ‰ø°‰∏≠...</p>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        let cardCount = 1;
        const PRICES = {
            standard: 3000,
            express: 5000
        };

        // „Ç´„Éº„ÉâËøΩÂä†Ê©üËÉΩ
        function addCard() {
            const container = document.getElementById('cardsContainer');
            const cardIndex = cardCount;

            const cardHTML = `
                <div class="card-section" data-card-index="${cardIndex}">
                    <div class="card-header">
                        <span class="card-title">„Ç´„Éº„Éâ ${cardIndex + 1}</span>
                        <button type="button" class="remove-card" onclick="removeCard(${cardIndex})">ÂâäÈô§</button>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>„Ç´„Éº„ÉâÂêç<span class="required">*</span></label>
                            <input type="text" name="cardName_${cardIndex}" required placeholder="‰æã: „Éî„Ç´„ÉÅ„É•„Ç¶ VMAX">
                        </div>
                        <div class="form-group">
                            <label>„Çª„ÉÉ„ÉàÂêç</label>
                            <input type="text" name="cardSet_${cardIndex}" placeholder="‰æã: 25th Anniversary">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>„Ç´„Éº„ÉâÁï™Âè∑</label>
                            <input type="text" name="cardNumber_${cardIndex}" placeholder="‰æã: 001/025">
                        </div>
                        <div class="form-group">
                            <label>Ë®ÄË™û</label>
                            <select name="cardLanguage_${cardIndex}">
                                <option value="Êó•Êú¨Ë™û">Êó•Êú¨Ë™û</option>
                                <option value="Ëã±Ë™û">Ëã±Ë™û</option>
                                <option value="„Åù„ÅÆ‰ªñ">„Åù„ÅÆ‰ªñ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ÊúüÂæÖ„Ç∞„É¨„Éº„Éâ</label>
                        <select name="expectedGrade_${cardIndex}">
                            <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                            <option value="10">PSA 10 (GEM MINT)</option>
                            <option value="9">PSA 9 (MINT)</option>
                            <option value="8">PSA 8 (NM-MT)</option>
                            <option value="7">PSA 7 (NM)</option>
                            <option value="6‰ª•‰∏ã">PSA 6‰ª•‰∏ã</option>
                            <option value="‰∏çÊòé">„Çè„Åã„Çâ„Å™„ÅÑ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ÂÇôËÄÉÔºà„Ç´„Éº„Éâ„ÅÆÁä∂ÊÖã„Å™„Å©Ôºâ</label>
                        <textarea name="cardNotes_${cardIndex}" placeholder="„Ç´„Éº„Éâ„ÅÆÁä∂ÊÖã„ÇÑÁâπË®ò‰∫ãÈ†Ö„Åå„ÅÇ„Çå„Å∞Ë®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
                    </div>
                </div>
            `;

            container.insertAdjacentHTML('beforeend', cardHTML);
            cardCount++;
            updateTotal();
        }

        // „Ç´„Éº„ÉâÂâäÈô§Ê©üËÉΩ
        function removeCard(index) {
            const card = document.querySelector(`[data-card-index="${index}"]`);
            if (card) {
                card.remove();
                updateTotal();
            }
        }

        // „Çµ„Éº„Éì„ÇπÈÅ∏Êäû
        function selectService(type) {
            document.getElementById(type + 'Service').checked = true;
            document.querySelectorAll('.service-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            updateTotal();
        }

        // ÂêàË®àÈáëÈ°çÊõ¥Êñ∞
        function updateTotal() {
            const cards = document.querySelectorAll('.card-section').length;
            const serviceType = document.querySelector('input[name="serviceType"]:checked').value;
            const price = PRICES[serviceType];
            const subtotal = cards * price;
            const tax = subtotal * 0.1;
            const total = subtotal + tax;

            document.getElementById('totalCards').textContent = `${cards}Êûö`;
            document.getElementById('servicePrice').textContent = `¬•${price.toLocaleString()}/Êûö`;
            document.getElementById('totalAmount').textContent = `¬•${total.toLocaleString()}`;
        }

        // „Éï„Ç©„Éº„É†ÈÄÅ‰ø°Âá¶ÁêÜ
        document.getElementById('applicationForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            // Âà©Áî®Ë¶èÁ¥Ñ„ÅÆÂêåÊÑèÁ¢∫Ë™ç
            if (!document.getElementById('agreeTerms').checked) {
                alert('Âà©Áî®Ë¶èÁ¥Ñ„Å´ÂêåÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                return;
            }

            // UIÊõ¥Êñ∞
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';

            try {
                // „Éï„Ç©„Éº„É†„Éá„Éº„ÇøÂèéÈõÜ
                const formData = new FormData(e.target);

                // „Ç´„Éº„ÉâÊÉÖÂ†±„ÇíÈÖçÂàó„Å®„Åó„Å¶Êï¥ÁêÜ
                const cards = [];
                document.querySelectorAll('.card-section').forEach((cardSection, index) => {
                    const cardIndex = cardSection.dataset.cardIndex;
                    cards.push({
                        name: formData.get(`cardName_${cardIndex}`),
                        set: formData.get(`cardSet_${cardIndex}`),
                        number: formData.get(`cardNumber_${cardIndex}`),
                        language: formData.get(`cardLanguage_${cardIndex}`),
                        expectedGrade: formData.get(`expectedGrade_${cardIndex}`),
                        notes: formData.get(`cardNotes_${cardIndex}`)
                    });
                });

                // ÈÄÅ‰ø°„Éá„Éº„ÇøÊßãÁØâ
                const applicationData = {
                    // È°ßÂÆ¢ÊÉÖÂ†±
                    customerName: formData.get('lastName') + ' ' + formData.get('firstName'),
                    customerEmail: formData.get('email'),
                    customerPhone: formData.get('phone'),
                    postalCode: formData.get('postalCode'),
                    address: formData.get('address'),

                    // „Ç´„Éº„ÉâÊÉÖÂ†±
                    cards: cards,
                    cardCount: cards.length,

                    // „Çµ„Éº„Éì„ÇπÊÉÖÂ†±
                    serviceType: formData.get('serviceType'),
                    specialRequests: formData.get('specialRequests'),

                    // ÊñôÈáëÊÉÖÂ†±
                    unitPrice: PRICES[formData.get('serviceType')],
                    totalAmount: cards.length * PRICES[formData.get('serviceType')] * 1.1,

                    // „É°„ÇøÊÉÖÂ†±
                    submittedAt: new Date().toISOString(),
                    status: 'pending',
                    country: 'Japan'
                };

                // API„Å∏ÈÄÅ‰ø°ÔºàË™çË®º„Å™„Åó„ÅÆ„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„Çí‰ΩúÊàê„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„ÅôÔºâ
                const response = await fetch('/api/public/psa-application', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(applicationData)
                });

                const result = await response.json();

                if (result.success) {
                    // ÊàêÂäüÊôÇ„ÅÆÂá¶ÁêÜ
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('applicationForm').reset();

                    // „Ç´„Éº„Éâ„Çª„ÇØ„Ç∑„Éß„É≥„Çí„É™„Çª„ÉÉ„Éà
                    document.getElementById('cardsContainer').innerHTML = '';
                    cardCount = 0;
                    addCard();
                    updateTotal();

                    // „Çπ„ÇØ„É≠„Éº„É´„Éà„ÉÉ„Éó
                    window.scrollTo(0, 0);
                } else {
                    throw new Error(result.message || 'ÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('errorMessage').textContent = error.message || '„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ';
                document.getElementById('errorMessage').style.display = 'block';
            } finally {
                document.getElementById('submitBtn').disabled = false;
                document.getElementById('loadingSpinner').style.display = 'none';
            }
        });

        // ÂàùÊúüË®≠ÂÆö
        document.addEventListener('DOMContentLoaded', () => {
            updateTotal();
            document.querySelector('.service-option').classList.add('selected');
        });
    </script>
</body>
</html>